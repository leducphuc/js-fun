{"version":3,"sources":["Promise.js","ex1.js"],"names":["_Promise","func","status","value","handlers","resolve","bind","then","reject","catch","setTimeout","params","length","_","others","nextChain","forEach","callback","cbType","push","count","fakeAjax","url","cb","fake_responses","randomDelay","Math","round","random","output","text","console","log","getFile","file","out1","result"],"mappings":"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","file":"ex1.a1e706d4.map","sourceRoot":"..","sourcesContent":["export default class _Promise {\n    constructor(func) {\n        this.func = func;\n        this.status = 0;\n        this.value = null;\n        this.handlers = [];\n        this.resolve = this.resolve.bind(this);\n        this.then = this.then.bind(this);\n        this.reject = this.reject.bind(this);\n        this.catch = this.catch.bind(this);\n        setTimeout(() => func(this.resolve, this.reject), 0);\n    }\n\n    resolve(params) {\n        this.status = 1;\n        this.value = params;\n        if (this.handlers.length) {\n            const [_, ...others] = this.handlers;\n            if (params instanceof _Promise) {\n                setTimeout(() => {\n                    const nextChain = params;\n                    this.handlers.forEach(func => nextChain.then(func));\n                    return nextChain;\n\n                }, 0);\n            } else {\n                setTimeout(() => {\n                    const nextChain =  new _Promise((resolve, reject) => {\n                        resolve(this.handlers[0](this.value))\n                    })\n                    others.forEach(func => nextChain.then(func));\n                    return nextChain\n\n                }, 0);\n            }\n        }\n    }\n\n    reject(params) {\n        this.status = 2;\n        return this;\n    }\n\n    then(callback) {\n        const cbType = typeof callback;\n        if (cbType === 'function') {\n            if (this.status === 0) {\n                this.handlers.push(callback);\n                return this;\n            } else if (this.status === 1) {\n                return new _Promise((resolve, reject) => resolve(callback(this.value)));\n            }\n        }\n    }\n\n    catch(callback) {\n        if (this.status = 2) {\n           this.value = callback(this.value);\n           return this;\n        }\n        return this;\n    }\n\n    done() {\n    }\n\n    finnaly() {\n    }\n}","import _Promise from './Promise';\nlet count = 0;\nfunction fakeAjax(url,cb) {\n\tcount ++;\n\tvar fake_responses = {\n\t\t\"file1\": \"The first text\",\n\t\t\"file2\": \"The middle text\",\n\t\t\"file3\": \"The last text\"\n\t};\n\tvar randomDelay = ((Math.round(Math.random() * 1E4) % 8000) + 1000)*count;\n\n\treturn new _Promise((resolve, reject) => {\n\t\t setTimeout(function(){\n\t\t\tresolve(fake_responses[ url ]);\n\t\t\t// try {\n\t\t\t// \tif (randomDelay > 1600) throw new Error();\n\t\t\t// \tresolve(fake_responses[ url ]);\n\t\t\t// }\n\t\t\t//  catch (error) {\n\t\t\t// \treturn Promise.resolve((fakeAjax( url )));\n\t\t\t// }\n\t\t},randomDelay);\n\t})\n}\n\nfunction output(text) {\n\tconsole.log(text);\n}\n\nfunction getFile(file, log) {\n\tif (log) {\n\t\tconsole.log(log);\n\t}\n\treturn fakeAjax(file)\n}\n\nconst out1 = () => console.log('final');\n\nconst result = () => getFile(\"file1\")\n.then((result) => getFile(\"file2\", result))\n.then((result) => getFile(\"file3\", result))\n.then((result) => getFile(\"file1\", result))\n.then((result) => getFile(\"file2\", result))\n.then((result) => getFile(\"file3\", result))\n.then((result) => getFile(\"file1\", result))\n.then((result) => getFile(\"file2\", result))\n.then((result) => getFile(\"file3\", result))\n.then((result) => getFile(\"file1\", result))\n.then((result) => getFile(\"file2\", result))\n.then((result) => getFile(\"file3\", result))\n.then((result) => getFile(\"file1\", result))\n.then((result) => getFile(\"file2\", result))\n.then((result) => getFile(\"file3\", result))\n.then((result) => getFile(\"file1\", result))\n.then((result) => getFile(\"file1\", result))\n.then((result) => getFile(\"file2\", result))\n.then((result) => getFile(\"file3\", result))\n.then((result) => getFile(\"file3\", result))\n.then((result) => getFile(\"file1\", result))\n.then((result) => getFile(\"file2\", result))\n.then((result) => getFile(\"file3\", result))\n.then((result) => getFile(\"file1\", result))\n.then((result) => getFile(\"file2\", result))\n.then(out1);\n// .catch(() => console.log('1234'))\nresult();\n"]}